import t from"mapbox-gl";var e="function"==typeof Object.assign?Object.assign:function(t,e){var n=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),r=1,i=arguments.length;r<i;++r){var s=n[r];if(null!=s)for(var a in s)s.hasOwnProperty(a)&&(o[a]=s[a])}return o};function n(t){for(var e in t)delete t[e]}function o(t,e,n,o){for(var r,i=0,s=t.length;i<s;++i)if((r=t[i]).listener===e&&r.bindTo===n)return o&&(r.deleteIndex=i),r}function r(t,e){var n=i(t);return n?n[e]:void 0}function i(t,e){var n=t.ol_lm;return!n&&e&&(n=t.ol_lm={}),n}function s(t,e){var o=r(t,e);if(o){for(var s=0,a=o.length;s<a;++s)t.removeEventListener(e,o[s].boundListener),n(o[s]);o.length=0;var u=i(t);u&&(delete u[e],0===Object.keys(u).length&&function(t){delete t.ol_lm}(t))}}function a(t,e,n,r,s){var a=i(t,!0),u=a[e];u||(u=a[e]=[]);var c=o(u,n,r,!1);return c?s||(c.callOnce=!1):(t.addEventListener(e,function(t){var e=function(e){var n=t.listener,o=t.bindTo||t.target;return t.callOnce&&p(t),n.call(o,e)};return t.boundListener=e,e}(c={bindTo:r,callOnce:!!s,listener:n,target:t,type:e})),u.push(c)),c}function u(t,e,n,o){return a(t,e,n,o,!0)}function c(t,e,n,i){var s=r(t,e);if(s){var a=o(s,n,i,!0);a&&p(a)}}function p(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);var e=r(t.target,t.type);if(e){var o="deleteIndex"in t?t.deleteIndex:e.indexOf(t);-1!==o&&e.splice(o,1),0===e.length&&s(t.target,t.type)}n(t)}}function h(){return function(){throw new Error("Unimplemented abstract method.")}()}var l=0;function f(t){return t.ol_uid||(t.ol_uid=String(++l))}var y=function(){this.disposed_=!1};function g(){}y.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},y.prototype.disposeInternal=function(){};var d=function(t){this.type=t,this.target=null};d.prototype.preventDefault=function(){this.propagationStopped=!0},d.prototype.stopPropagation=function(){this.propagationStopped=!0};var _=function(t){function e(){t.call(this),this.revision_=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.changed=function(){++this.revision_,this.dispatchEvent("change")},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var n=t.length,o=new Array(n),r=0;r<n;++r)o[r]=a(this,t[r],e);return o}return a(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var n=t.length,o=new Array(n),r=0;r<n;++r)o[r]=u(this,t[r],e);return o}return u(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var n=0,o=t.length;n<o;++n)c(this,t[n],e);else c(this,t,e)},e}(function(t){function e(){t.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.addEventListener=function(t,e){var n=this.listeners_[t];n||(n=this.listeners_[t]=[]),-1===n.indexOf(e)&&n.push(e)},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new d(t):t,n=e.type;e.target=this;var o,r=this.listeners_[n];if(r){n in this.dispatching_||(this.dispatching_[n]=0,this.pendingRemovals_[n]=0),++this.dispatching_[n];for(var i=0,s=r.length;i<s;++i)if(!1===r[i].call(this,e)||e.propagationStopped){o=!1;break}if(--this.dispatching_[n],0===this.dispatching_[n]){var a=this.pendingRemovals_[n];for(delete this.pendingRemovals_[n];a--;)this.removeEventListener(n,g);delete this.dispatching_[n]}return o}},e.prototype.disposeInternal=function(){!function(t){var e=i(t);if(e)for(var n in e)s(t,n)}(this)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var n=this.listeners_[t];if(n){var o=n.indexOf(e);t in this.pendingRemovals_?(n[o]=g,++this.pendingRemovals_[t]):(n.splice(o,1),0===n.length&&delete this.listeners_[t])}},e}(y)),v=function(t){function e(e,n,o){t.call(this,e),this.key=n,this.oldValue=o}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(d),E={};function m(t){return E.hasOwnProperty(t)?E[t]:E[t]="change:"+t}var S={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"};Error;var x="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2},O=function(t){function n(n){var o=e({},n);delete o.source,t.call(this,o),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,n.map&&this.setMap(n.map),a(this,m(S.SOURCE),this.handleSourcePropertyChange_,this),this.setSource(n.source?n.source:null)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},n.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},n.prototype.getSource=function(){return this.get(S.SOURCE)||null},n.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():"undefined"},n.prototype.handleSourceChange_=function(){this.changed()},n.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(p(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=a(t,"change",this.handleSourceChange_,this)),this.changed()},n.prototype.setMap=function(t){this.mapPrecomposeKey_&&(p(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(p(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=a(t,"precompose",function(t){var e=t,n=this.getLayerState();n.managed=!1,void 0===this.getZIndex()&&(n.zIndex=Infinity),e.frameState.layerStatesArray.push(n),e.frameState.layerStates[f(this)]=n},this),this.mapRenderKey_=a(this,"change",t.render,t),this.changed())},n.prototype.setSource=function(t){this.set(S.SOURCE,t)},n}(function(t){function n(n){t.call(this);var o=e({},n);o[S.OPACITY]=void 0!==n.opacity?n.opacity:1,o[S.VISIBLE]=void 0===n.visible||n.visible,o[S.Z_INDEX]=n.zIndex,o[S.MAX_RESOLUTION]=void 0!==n.maxResolution?n.maxResolution:Infinity,o[S.MIN_RESOLUTION]=void 0!==n.minResolution?n.minResolution:0,this.setProperties(o),this.state_=null}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.getType=function(){return this.type},n.prototype.getLayerState=function(){var t,e=this.state_||{layer:this,managed:!0};return e.opacity=(t=this.getOpacity(),Math.min(Math.max(t,0),1)),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=this.getZIndex()||0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),this.state_=e,e},n.prototype.getLayersArray=function(t){return h()},n.prototype.getLayerStatesArray=function(t){return h()},n.prototype.getExtent=function(){return this.get(S.EXTENT)},n.prototype.getMaxResolution=function(){return this.get(S.MAX_RESOLUTION)},n.prototype.getMinResolution=function(){return this.get(S.MIN_RESOLUTION)},n.prototype.getOpacity=function(){return this.get(S.OPACITY)},n.prototype.getSourceState=function(){return h()},n.prototype.getVisible=function(){return this.get(S.VISIBLE)},n.prototype.getZIndex=function(){return this.get(S.Z_INDEX)},n.prototype.setExtent=function(t){this.set(S.EXTENT,t)},n.prototype.setMaxResolution=function(t){this.set(S.MAX_RESOLUTION,t)},n.prototype.setMinResolution=function(t){this.set(S.MIN_RESOLUTION,t)},n.prototype.setOpacity=function(t){this.set(S.OPACITY,t)},n.prototype.setVisible=function(t){this.set(S.VISIBLE,t)},n.prototype.setZIndex=function(t){this.set(S.Z_INDEX,t)},n}(function(t){function n(e){t.call(this),f(this),this.values_={},void 0!==e&&this.setProperties(e)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},n.prototype.getKeys=function(){return Object.keys(this.values_)},n.prototype.getProperties=function(){return e({},this.values_)},n.prototype.notify=function(t,e){var n;n=m(t),this.dispatchEvent(new v(n,t,e)),this.dispatchEvent(new v(n="propertychange",t,e))},n.prototype.set=function(t,e,n){if(n)this.values_[t]=e;else{var o=this.values_[t];this.values_[t]=e,o!==e&&this.notify(t,o)}},n.prototype.setProperties=function(t,e){for(var n in t)this.set(n,t[n],e)},n.prototype.unset=function(t,e){if(t in this.values_){var n=this.values_[t];delete this.values_[t],e||this.notify(t,n)}},n}(_))),b={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},R={};R[b.DEGREES]=2*Math.PI*6370997/360,R[b.FEET]=.3048,R[b.METERS]=1,R[b.USFEET]=1200/3937;var I=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};I.prototype.canWrapX=function(){return this.canWrapX_},I.prototype.getCode=function(){return this.code_},I.prototype.getExtent=function(){return this.extent_},I.prototype.getUnits=function(){return this.units_},I.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||R[this.units_]},I.prototype.getWorldExtent=function(){return this.worldExtent_},I.prototype.getAxisOrientation=function(){return this.axisOrientation_},I.prototype.isGlobal=function(){return this.global_},I.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},I.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},I.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},I.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},I.prototype.setWorldExtent=function(t){this.worldExtent_=t},I.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},I.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};var P,w,T,M=6378137,L=Math.PI*M,C=[-L,-L,L,L],G=[-180,-85,180,85],A=function(t){function e(e){t.call(this,{code:e,units:b.METERS,extent:C,global:!0,worldExtent:G,getPointResolution:function(t,e){return t/x(e[1]/M)}})}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(I),U=[new A("EPSG:3857"),new A("EPSG:102100"),new A("EPSG:102113"),new A("EPSG:900913"),new A("urn:ogc:def:crs:EPSG:6.18:3:3857"),new A("urn:ogc:def:crs:EPSG::3857"),new A("http://www.opengis.net/gml/srs/epsg.xml#3857")],j=[-180,-90,180,90],N=6378137*Math.PI/180,X=function(t){function e(e,n){t.call(this,{code:e,units:b.DEGREES,extent:j,axisOrientation:n,global:!0,metersPerUnit:N,worldExtent:j})}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(I),K=[new X("CRS:84"),new X("EPSG:4326","neu"),new X("urn:ogc:def:crs:EPSG::4326","neu"),new X("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new X("urn:ogc:def:crs:OGC:1.3:CRS84"),new X("urn:ogc:def:crs:OGC:2:84"),new X("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new X("urn:x-ogc:def:crs:EPSG:4326","neu")],k={},Z={};function D(t,e,n){var o=t.getCode(),r=e.getCode();o in Z||(Z[o]={}),Z[o][r]=n}function V(t,e,n){var o;if(void 0!==e){for(var r=0,i=t.length;r<i;++r)e[r]=t[r];o=e}else o=t.slice();return o}function F(t,e,n){if(void 0!==e&&t!==e){for(var o=0,r=t.length;o<r;++o)e[o]=t[o];t=e}return t}function W(t){!function(t,e){k[t]=e}(t.getCode(),t),D(t,t,V)}function z(t){return"string"==typeof t?k[t]||null:t||null}function B(t){!function(t){t.forEach(W)}(t),t.forEach(function(e){t.forEach(function(t){e!==t&&D(e,t,V)})})}B(U),B(K),P=U,w=function(t,e,n){var o=t.length,r=n>1?n:2,i=e;void 0===i&&(i=r>2?t.slice():new Array(o));for(var s=L,a=0;a<o;a+=r){i[a]=s*t[a]/180;var u=M*Math.log(Math.tan(Math.PI*(t[a+1]+90)/360));u>s?u=s:u<-s&&(u=-s),i[a+1]=u}return i},T=function(t,e,n){var o=t.length,r=n>1?n:2,i=e;void 0===i&&(i=r>2?t.slice():new Array(o));for(var s=0;s<o;s+=r)i[s]=180*t[s]/L,i[s+1]=360*Math.atan(Math.exp(t[s+1]/M))/Math.PI-90;return i},K.forEach(function(t){P.forEach(function(e){D(t,e,w),D(e,t,T)})});var Y=function(t){function e(e){t.call(this),this.layer=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.handles=function(t){return t instanceof q},e.create=function(t,n){return new e(n)},e.prototype.prepareFrame=function(t){var e=this.layer,n=this.layer.mapboxMap,o=n.getCanvas(),r=t.viewState,i=e.getVisible();o.style.display=i?"block":"none";var s=e.getOpacity().toString();s!==o.style.opacity&&(o.style.opacity=s);var a,u,c,p,h=r.rotation;return h&&n.rotateTo(180*-h/Math.PI,{animate:!1}),n.jumpTo({center:(a=r.center,c=function(t,e,n){return function(t,e){var n,o,r,i=(n=t.getCode(),o=e.getCode(),n in Z&&o in Z[n]&&(r=Z[n][o]),r);return i||(i=F),i}(z("EPSG:3857"),z("EPSG:4326"))(t,void 0,t.length)}(a),p=c[0],(p<-180||p>180)&&(c[0]=(360*(u=(p+180)%360)<0?u+360:u)-180),c),zoom:r.zoom-1,animate:!1}),n._frame&&(n._frame.cancel(),n._frame=null),n._render(),!1},e}(_),q=function(e){function n(n){var o=Object.assign({},n);delete o.accessToken,delete o.style,delete o.container,e.call(this,o),n.accessToken&&(t.accessToken=n.accessToken),this.mapboxMap=new t.Map({container:n.container,style:n.style,attributionControl:!1,boxZoom:!1,doubleClickZoom:!1,dragPan:!1,dragRotate:!1,interactive:!1,keyboard:!1,pitchWithRotate:!1,scrollZoom:!1,touchZoomRotate:!1})}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getSourceState=function(){return"ready"},n.prototype.setLayerVisibility=function(t,e){this.mapboxMap.setLayoutProperty(t,"visibility",e?"visible":"none")},n}(O);export default q;export{Y as MapBoxLayerRenderer};
//# sourceMappingURL=mapboxlayer-legacy.js.map
